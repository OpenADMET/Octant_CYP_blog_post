---
title: "CYP Clearance Assay"
author: "Robert Warneford-Thomson"
date: today
---

```{r}
#| label: setup-variables
#| cache: false

here::i_am("index.qmd")
wd <- here::here()
Sys.setenv(REPO_ROOT = here::here())
```

### Environment setup

Run this chunk manually once to initialize renv and install dependencies.
Subsequent renders will use the lockfile to restore the environment.

```{r}
#| label: env-setup
#| eval: false
#| echo: true

# initialize renv, select option 3 to activate the project without snapshotting or installing any packages
renv::init(
  project = wd
)

depends <- c(
  "ggbeeswarm",
  "ggh4x",
  "ggpubr",
  "here",
  "patchwork",
  "plotly",
  "png",
  "reticulate",
  "scico",
  "tidyverse"
)

options(renv.config.pak.enabled = FALSE)
renv::install(depends, prompt = FALSE, dependencies = TRUE, project = wd)

# snapshot dependencies
renv::snapshot(prompt = FALSE, project = wd)
```

### Attach packages

Load the renv environment and attach required packages.

```{r}
#| label: attach-packages
#| cache: false
#| message: true

renv::load(project = wd)

library(tidyverse)
library(ggplot2)
library(ggbeeswarm)
library(ggh4x)
library(ggpubr)
library(patchwork)
library(plotly)
library(here)

source(here("R", "helpers.R"))
theme_set(theme_pub(base_size = 12))
```

```{python}
#| label: python-setup
#| cache: false
#| echo: false

import os
import numpy as np
import pandas as pd
from pathlib import Path
from rdkit import Chem
from rdkit.Chem import Draw
from bokeh.plotting import figure as bokeh_figure, show
from bokeh.models import ColumnDataSource, HoverTool
from bokeh.embed import components
from bokeh.resources import CDN
from IPython.display import HTML

repo_root = Path(os.environ["REPO_ROOT"])
```

## Figure 1

{{< include figures/figure_1.qmd >}}

## Figure 2: Assay Development

{{< include figures/figure_2.qmd >}}

## Figure 3

{{< include figures/figure_3.qmd >}}

## Figure 4

{{< include figures/figure_4.qmd >}}
